@using LogiEdge.CustomerService.Data
@using LogiEdge.WarehouseService.Data
@code {
    [Parameter]
    public required ItemsTableColumnDisplayParameters ColumnDisplayParameters { get; set; }
    [Parameter]
    public EventCallback<ItemsTableColumnDisplayParameters> ColumnDisplayParametersChanged { get; set; }

    [Parameter]
    public required ItemsTableFilterParameters FilterParameters { get; set; }
    [Parameter]
    public EventCallback<ItemsTableFilterParameters> FilterParametersChanged { get; set; }

    [Parameter]
    public required ItemsTableSortParameters SortParameters { get; set; }
    [Parameter]
    public EventCallback<ItemsTableSortParameters> SortParametersChanged { get; set; }
}

@{
    RenderFragment<(Item item, ItemState itemState, OrderedDictionary<string, object?> properties)> tableRowRenderFragment =
        data => __builder =>
        {
            <tr>
                @foreach ((string propertyName, object? propertyValue) in data.properties)
                {
                    <td>
                        @switch (propertyName)
                        {
                            case nameof(Item.Id):
                                <a href="/warehouse/item/@data.item.Id">
                                    <PropertyValueComponent PropertyValue="@propertyValue" />
                                </a>
                                break;
                            case nameof(Item.Customer):
                                Customer c = (Customer)propertyValue;
                                <a href="javascript:void(0);"
                                   @onclick="() => FilterParametersChanged.InvokeAsync(FilterParameters.WithParameter(nameof(Item.Customer), c.Id))">
                                    <PropertyValueComponent PropertyValue="@propertyValue" />
                                </a>
                                break;
                            case nameof(ItemState.Warehouse):
                                Warehouse w = (Warehouse)propertyValue;
                                <a href="javascript:void(0);"
                                   @onclick="() => FilterParametersChanged.InvokeAsync(FilterParameters.WithParameter(nameof(ItemState.Warehouse), w.Id))">
                                    <PropertyValueComponent PropertyValue="@propertyValue" />
                                </a>
                                break;
                            default:
                                <a href="javascript:void(0);"
                                   @onclick="() => FilterParametersChanged.InvokeAsync(FilterParameters.WithParameter(propertyName, propertyValue.ToString()))">
                                    <PropertyValueComponent PropertyValue="@propertyValue" />
                                </a>
                                break;
                        }
                    </td>
                }
            </tr>
        };
}



<WarehouseItemTableComponent ColumnDisplayParameters="ColumnDisplayParameters"
                             ColumnDisplayParametersChanged="ColumnDisplayParametersChanged"
                             FilterParameters="FilterParameters"
                             FilterParametersChanged="FilterParametersChanged"
                             SortParameters="SortParameters"
                             SortParametersChanged="SortParametersChanged"
                             TableRowRenderFragment="tableRowRenderFragment" />